{
  "$schema": "https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.5.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "testhost",
          "organization": "Microsoft Corporation",
          "product": "Microsoft.TestHost",
          "fullName": "testhost 15.0.0.0",
          "version": "15.0.0.0",
          "semanticVersion": "15.0.0",
          "rules": [
            {
              "id": "AZC101/240",
              "name": "DontMakeSecretsAvailableToForkedBuilds",
              "fullDescription": {
                "text": "Do not make secrets available to builds for fork of public repository."
              },
              "messageStrings": {
                "NotApplicable_InvalidMetadata": {
                  "text": "'{0}' was not evaluated for check '{1}' because the analysis is not relevant for the following reason: {2}."
                },
                "Default": {
                  "text": "[Build Definition Id:{0}]({1}) in organization '{2}' project '{3}' was found {4} {5} {6}."
                }
              },
              "helpUri": "https://github.com/microsoft/sarif-pattern-matcher"
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true
        }
      ],
      "results": [
        {
          "ruleId": "AZC101/240",
          "ruleIndex": 0,
          "level": "error",
          "message": {
            "id": "Default",
            "arguments": [
              "AZC101.builddefinition.DontMakeSecretsAvailableToForkedBuilds.json",
              "",
              "test-org",
              "33df262c-872a-d2c5-a674-cd60cb6e11ef",
              "its build pipeline secrets available for builds of forks.",
              "For GitHub public repositories, it is possible that people from outside the organization can create forks and run builds on the forked repo. In such a case, if this setting is wrongly left enabled, outsiders can get access to build pipeline secrets that were meant to be internal.",
              "Recommendation: 1. Navigate to the build pipeline using resource link -->  2. Triggers --> 3. Pull request validation --> 4. Forks --> 5. Uncheck 'Make secrets available to builds of forks'"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/Plugins/Tests.AzureDevOpsConfiguration/TestData/BuildDefinitionSecurity/Inputs/AZC101.builddefinition.DontMakeSecretsAvailableToForkedBuilds.json",
                  "uriBaseId": "SRC_ROOT"
                },
                "region": {
                  "startLine": 2,
                  "startColumn": 2,
                  "endLine": 159,
                  "endColumn": 52,
                  "charOffset": 4,
                  "charLength": 5494,
                  "snippet": {
                    "text": "\"EtlEntity\": \"builddefinitions\",\r\n\t\"EtlIngestDate\": \"2019-07-19T21:43:08.2172009Z\",\r\n\t\"options\": [\r\n\t\t{\r\n\t\t\t\"enabled\": false,\r\n\t\t\t\"definition\": {\r\n\t\t\t\t\"id\": \"51a3ca5a-403c-48a1-aef2-ba852325a43e\"\r\n\t\t\t},\r\n\t\t\t\"inputs\": {}\r\n\t\t}\r\n\t],\r\n\t\"triggers\": [\r\n\t\t{\r\n\t\t\t\"branchFilters\": [],\r\n\t\t\t\"pathFilters\": [],\r\n\t\t\t\"settingsSourceType\": 2,\r\n\t\t\t\"batchChanges\": false,\r\n\t\t\t\"maxConcurrentBuildsPerBranch\": 1,\r\n\t\t\t\"triggerType\": \"continuousIntegration\"\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"settingsSourceType\": 2,\r\n\t\t\t\"branchFilters\": [\r\n\t\t\t\t\"+master\"\r\n\t\t\t],\r\n\t\t\t\"forks\": {\r\n\t\t\t\t\"enabled\": true,\r\n\t\t\t\t\"allowSecrets\": true\r\n\t\t\t},\r\n\t\t\t\"pathFilters\": [],\r\n\t\t\t\"requireCommentsForNonTeamMembersOnly\": false,\r\n\t\t\t\"isCommentRequiredForPullRequest\": false,\r\n\t\t\t\"triggerType\": \"pullRequest\"\r\n\t\t}\r\n\t],\r\n\t\"variables\": {\r\n\t\t\"system.debug\": {\r\n\t\t\t\"value\": \"true\",\r\n\t\t\t\"allowOverride\": true\r\n\t\t},\r\n\t\t\"VERSION\": {\r\n\t\t\t\"value\": \"1.0\"\r\n\t\t}\r\n\t},\r\n\t\"properties\": {},\r\n\t\"tags\": [],\r\n\t\"_links\": {\r\n\t\t\"self\": {\r\n\t\t\t\"href\": \"https://dev.azure.com/test-org/33df262c-872a-d2c5-a674-cd60cb6e11ef/_apis/build/Definitions/17?revision=3\"\r\n\t\t},\r\n\t\t\"web\": {\r\n\t\t\t\"href\": \"https://dev.azure.com/test-org/33df262c-872a-d2c5-a674-cd60cb6e11ef/_build/definition?definitionId=17\"\r\n\t\t},\r\n\t\t\"editor\": {\r\n\t\t\t\"href\": \"https://dev.azure.com/test-org/33df262c-872a-d2c5-a674-cd60cb6e11ef/_build/designer?id=17&_a=edit-build-definition\"\r\n\t\t},\r\n\t\t\"badge\": {\r\n\t\t\t\"href\": \"https://dev.azure.com/test-org/33df262c-872a-d2c5-a674-cd60cb6e11ef/_apis/build/status/17\"\r\n\t\t}\r\n\t},\r\n\t\"jobAuthorizationScope\": \"projectCollection\",\r\n\t\"jobTimeoutInMinutes\": 60,\r\n\t\"jobCancelTimeoutInMinutes\": 5,\r\n\t\"badgeEnabled\": true,\r\n\t\"process\": {\r\n\t\t\"yamlFilename\": \"ci/continuous-build.yml\",\r\n\t\t\"type\": 2\r\n\t},\r\n\t\"repository\": {\r\n\t\t\"properties\": {\r\n\t\t\t\"apiUrl\": \"https://api.github.com/repos/testcompany/azure-pipelines-artifact-caching-tasks\",\r\n\t\t\t\"branchesUrl\": \"https://api.github.com/repos/testcompany/azure-pipelines-artifact-caching-tasks/branches\",\r\n\t\t\t\"cloneUrl\": \"https://github.com/testcompany/azure-pipelines-artifact-caching-tasks.git\",\r\n\t\t\t\"connectedServiceId\": \"f29d632a-77d6-4c4c-aa50-6937a5c06b03\",\r\n\t\t\t\"defaultBranch\": \"master\",\r\n\t\t\t\"fullName\": \"testcompany/azure-pipelines-artifact-caching-tasks\",\r\n\t\t\t\"hasAdminPermissions\": \"False\",\r\n\t\t\t\"isFork\": \"False\",\r\n\t\t\t\"isPrivate\": \"False\",\r\n\t\t\t\"lastUpdated\": \"05/14/2019 10:58:18\",\r\n\t\t\t\"manageUrl\": \"https://github.com/testcompany/azure-pipelines-artifact-caching-tasks\",\r\n\t\t\t\"nodeId\": \"MDLwOlJlcX9zaXRvcnktNjkxNjr2OHM=\",\r\n\t\t\t\"ownerId\": \"1234567\",\r\n\t\t\t\"orgName\": \"testcompany\",\r\n\t\t\t\"refsUrl\": \"https://api.github.com/repos/testcompany/azure-pipelines-artifact-caching-tasks/git/refs\",\r\n\t\t\t\"shortName\": \"azure-pipelines-artifact-caching-tasks\",\r\n\t\t\t\"ownerAvatarUrl\": \"https://avatars2.githubusercontent.com/u/1234567?v=4\",\r\n\t\t\t\"archived\": \"False\",\r\n\t\t\t\"externalId\": \"123456789\",\r\n\t\t\t\"safeId\": \"testcompany/azure-pipelines-artifact-caching-tasks\",\r\n\t\t\t\"safeOwnerId\": \"1234567\",\r\n\t\t\t\"safeOwnerName\": \"testcompany\",\r\n\t\t\t\"safeRepository\": \"testcompany/azure-pipelines-artifact-caching-tasks\",\r\n\t\t\t\"ownerIsAUser\": \"False\",\r\n\t\t\t\"checkoutNestedSubmodules\": \"false\",\r\n\t\t\t\"cleanOptions\": \"0\",\r\n\t\t\t\"fetchDepth\": \"0\",\r\n\t\t\t\"gitLfsSupport\": \"false\",\r\n\t\t\t\"reportBuildStatus\": \"true\",\r\n\t\t\t\"skipSyncSource\": \"false\",\r\n\t\t\t\"labelSourcesFormat\": \"$(build.buildNumber)\",\r\n\t\t\t\"labelSources\": \"0\"\r\n\t\t},\r\n\t\t\"id\": \"testcompany/azure-pipelines-artifact-caching-tasks\",\r\n\t\t\"type\": \"GitHub\",\r\n\t\t\"name\": \"testcompany/azure-pipelines-artifact-caching-tasks\",\r\n\t\t\"url\": \"https://github.com/testcompany/azure-pipelines-artifact-caching-tasks.git\",\r\n\t\t\"defaultBranch\": \"master\",\r\n\t\t\"clean\": \"false\",\r\n\t\t\"checkoutSubmodules\": false\r\n\t},\r\n\t\"quality\": \"definition\",\r\n\t\"authoredBy\": {\r\n\t\t\"displayName\": \"Yong Yan\",\r\n\t\t\"url\": \"https://vssps.dev.azure.com/e/testcompany/_apis/Identities/077dcb0a-3503-40fb-a793-85d2efdf8c96\",\r\n\t\t\"_links\": {\r\n\t\t\t\"avatar\": {\r\n\t\t\t\t\"href\": \"https://dev.azure.com/test-org/_apis/GraphProfile/MemberAvatars/aad.NEUzMzA2NmYtNDBjMy43MzNlLFkxZaEtMjCiNTBvYTdhMzds\"\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"id\": \"77ee3796-43c3-4a07-bfa9-1a9157b6a252\",\r\n\t\t\"uniqueName\": \"etdenn@testcompany.com\",\r\n\t\t\"imageUrl\": \"https://dev.azure.com/test-org/_apis/GraphProfile/MemberAvatars/aad.NEUzMzA2NmYtNDBjMy43MzNlLFkxZaEtMjCiNTBvYTdhMzds\",\r\n\t\t\"descriptor\": \"aad.NEUzMzA2NmYtNDBjMy43MzNlLFkxZaEtMjCiNTBvYTdhMzds\"\r\n\t},\r\n\t\"drafts\": [],\r\n\t\"queue\": {\r\n\t\t\"_links\": {\r\n\t\t\t\"self\": {\r\n\t\t\t\t\"href\": \"https://dev.azure.com/test-org/_apis/build/Queues/46\"\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"id\": 46,\r\n\t\t\"url\": \"https://dev.azure.com/test-org/_apis/build/Queues/46\",\r\n\t\t\"pool\": null\r\n\t},\r\n\t\"id\": 17,\r\n\t\"name\": \"TestCompany.azure-pipelines-artifact-caching-tasks\",\r\n\t\"url\": \"https://dev.azure.com/test-org/33df262c-872a-d2c5-a674-cd60cb6e11ef/_apis/build/Definitions/17?revision=3\",\r\n\t\"uri\": \"vstfs:///Build/Definition/17\",\r\n\t\"path\": \"\\\\\",\r\n\t\"type\": \"build\",\r\n\t\"queueStatus\": \"enabled\",\r\n\t\"revision\": 3,\r\n\t\"createdDate\": \"2019-05-14T16:26:54.1Z\",\r\n\t\"project\": {\r\n\t\t\"id\": \"33df262c-872a-d2c5-a674-cd60cb6e11ef\",\r\n\t\t\"name\": \"azure-pipelines-artifact-caching-tasks\",\r\n\t\t\"url\": \"https://dev.azure.com/test-org/_apis/projects/33df262c-872a-d2c5-a674-cd60cb6e11ef\",\r\n\t\t\"state\": \"wellFormed\",\r\n\t\t\"revision\": 75,\r\n\t\t\"visibility\": \"public\",\r\n\t\t\"lastUpdateTime\": \"2019-02-06T16:56:10.827Z\"\r\n\t},\r\n\t\"_projectId\": \"33df262c-872a-d2c5-a674-cd60cb6e11ef\",\r\n\t\"_accountName\": \"test-org.visualstudio.com\",\r\n\t\"_sessionId\": \"95a60ee3-737f-4955-87a2-f0a2ada4dc58-test-org_AzureDevOpsHourly-1\",\r\n\t\"_originatingUri\": \"https://dev.azure.com/test-org"
                  }
                }
              }
            }
          ],
          "fingerprints": {
            "AssetFingerprint/v1": "",
            "ValidationFingerprint/v1": "[secret=8DFB5CD68EF3AD7A78D10284591F8D81ADD57FFDD8646DE80E846C63C95032DE]",
            "ValidationFingerprintHash/v1": "a5982fe308422353bb65ef8ed4a9715cedbcafb085e840eb025b3cee018b34c6",
            "AssetFingerprint/v2": "{}",
            "ValidationFingerprint/v2": "{\"secret\":\"8DFB5CD68EF3AD7A78D10284591F8D81ADD57FFDD8646DE80E846C63C95032DE\"}"
          },
          "rank": 53.78
        }
      ],
      "columnKind": "utf16CodeUnits"
    }
  ]
}