{
  "$schema": "https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.5.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "testhost",
          "organization": "Microsoft Corporation",
          "product": "Microsoft.TestHost",
          "fullName": "testhost 15.0.0.0",
          "version": "15.0.0.0",
          "semanticVersion": "15.0.0",
          "rules": [
            {
              "id": "AZC101/240",
              "name": "DoNotMakeSecretsAvailableToForkedBuilds",
              "fullDescription": {
                "text": "Do not make secrets available to builds for fork of public repository. In GitHub public repositories, it is possible for someone outside the organization to create and subsequently run builds on a forked copy. In this scenario, enabling the setting to make secrets available to builds of forks may expose build pipeline secrets that are meant to be to outsiders.\r\nRecommendation:\r\n1. Navigate to the build pipeline using the provided resource link\r\n2. Navigate to Triggers -> Pull request validation -> Forks\r\n3. Uncheck 'Make secrets available to builds of forks'."
              },
              "messageStrings": {
                "NotApplicable_InvalidMetadata": {
                  "text": "'{0}' was not evaluated for check '{1}' because the analysis is not relevant for the following reason: {2}."
                },
                "Default": {
                  "text": "Pipeline secrets for Build Definition [{0}](https://dev.azure.com/{1}/AzureDevOps/_apps/hub/ms.vss-ciworkflow.build-ci-hub?_a=edit-build-definition&id={3}&view=Tab_Triggers) in the '{1}' organization's '{2}' project are currently exposed to builds for repository forks."
                }
              },
              "helpUri": "https://docs.microsoft.com/en-us/azure/devops/pipelines/repos/github?view=azure-devops&tabs=yaml#important-security-considerations"
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true
        }
      ],
      "results": [
        {
          "ruleId": "AZC101/240",
          "ruleIndex": 0,
          "level": "error",
          "message": {
            "id": "Default",
            "arguments": [
              "TestCompany.azure-pipelines-artifact-caching-tasks",
              "test-org.visualstudio.com",
              "33df262c-872a-d2c5-a674-cd60cb6e11ef",
              "17"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/Plugins/Tests.AzureDevOpsConfiguration/TestData/BuildDefinitionSecurity/Inputs/AZC101.builddefinition.DontMakeSecretsAvailableToForkedBuilds.json",
                  "uriBaseId": "SRC_ROOT"
                },
                "region": {
                  "startLine": 27,
                  "startColumn": 4,
                  "endLine": 30,
                  "endColumn": 5,
                  "charOffset": 530,
                  "charLength": 64,
                  "snippet": {
                    "text": "\"forks\": {\r\n\t\t\t\t\"enabled\": true,\r\n\t\t\t\t\"allowSecrets\": true\r\n\t\t\t}"
                  }
                }
              }
            }
          ],
          "fingerprints": {
            "AssetFingerprint/v1": "",
            "ValidationFingerprint/v1": "[secret=\"forks\": {\r\n\t\t\t\t\"enabled\": true,\r\n\t\t\t\t\"allowSecrets\": true\r\n\t\t\t}]",
            "ValidationFingerprintHash/v1": "917d3587f19eadf26d647ea712818f54b3554eeaddea19886b596ea5a6a8d5f6",
            "AssetFingerprint/v2": "{}",
            "ValidationFingerprint/v2": "{\"secret\":\"\\\"forks\\\": {\\r\\n\\t\\t\\t\\t\\\"enabled\\\": true,\\r\\n\\t\\t\\t\\t\\\"allowSecrets\\\": true\\r\\n\\t\\t\\t}\"}"
          },
          "rank": 60.36
        }
      ],
      "columnKind": "utf16CodeUnits"
    }
  ]
}