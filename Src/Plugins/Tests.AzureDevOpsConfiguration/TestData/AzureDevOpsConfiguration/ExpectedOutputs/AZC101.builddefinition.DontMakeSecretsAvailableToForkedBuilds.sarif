{
  "$schema": "https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.5.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "testhost",
          "organization": "Microsoft Corporation",
          "product": "Microsoft.TestHost",
          "fullName": "testhost 15.0.0.0",
          "version": "15.0.0.0",
          "semanticVersion": "15.0.0",
          "rules": [
            {
              "id": "AZC101/240",
              "name": "BuildDefinitionShouldBeSecure/DontMakeSecretsAvailableToForkedBuilds",
              "fullDescription": {
                "text": "Do not make secrets available to builds for fork of public repository."
              },
              "messageStrings": {
                "NotApplicable_InvalidMetadata": {
                  "text": "'{0}' was not evaluated for check '{1}' because the analysis is not relevant for the following reason: {2}."
                },
                "Default": {
                  "text": "For GitHub public repositories, it is possible that people from outside the organization can create forks and run builds on the forked repo. In such a case, if this setting is wrongly left enabled, outsiders can get access to build pipeline secrets that were meant to be internal.\r\nRecommendation: 1. Navigate to the build pipeline using resource link -->  2. Triggers --> 3. Pull request validation --> 4. Forks --> 5. Uncheck 'Make secrets available to builds of forks'."
                }
              },
              "helpUri": "https://github.com/microsoft/sarif-pattern-matcher"
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true
        }
      ],
      "results": [
        {
          "ruleId": "AZC101/240",
          "ruleIndex": 0,
          "level": "error",
          "message": {
            "id": "Default"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/Plugins/Tests.AzureDevOpsConfiguration/TestData/AzureDevOpsConfiguration/Inputs/AZC101.builddefinition.DontMakeSecretsAvailableToForkedBuilds.json",
                  "uriBaseId": "SRC_ROOT"
                },
                "region": {
                  "startLine": 2,
                  "startColumn": 2,
                  "endLine": 34,
                  "endColumn": 32,
                  "charOffset": 4,
                  "charLength": 744,
                  "snippet": {
                    "text": "\"EtlEntity\": \"builddefinitions\",\r\n\t\"EtlIngestDate\": \"2019-07-19T21:43:08.2172009Z\",\r\n\t\"options\": [\r\n\t\t{\r\n\t\t\t\"enabled\": false,\r\n\t\t\t\"definition\": {\r\n\t\t\t\t\"id\": \"51a3ca5a-403c-48a1-aef2-ba852325a43e\"\r\n\t\t\t},\r\n\t\t\t\"inputs\": {}\r\n\t\t}\r\n\t],\r\n\t\"triggers\": [\r\n\t\t{\r\n\t\t\t\"branchFilters\": [],\r\n\t\t\t\"pathFilters\": [],\r\n\t\t\t\"settingsSourceType\": 2,\r\n\t\t\t\"batchChanges\": false,\r\n\t\t\t\"maxConcurrentBuildsPerBranch\": 1,\r\n\t\t\t\"triggerType\": \"continuousIntegration\"\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"settingsSourceType\": 2,\r\n\t\t\t\"branchFilters\": [\r\n\t\t\t\t\"+master\"\r\n\t\t\t],\r\n\t\t\t\"forks\": {\r\n\t\t\t\t\"enabled\": true,\r\n\t\t\t\t\"allowSecrets\": true\r\n\t\t\t},\r\n\t\t\t\"pathFilters\": [],\r\n\t\t\t\"requireCommentsForNonTeamMembersOnly\": false,\r\n\t\t\t\"isCommentRequiredForPullRequest\": false,\r\n\t\t\t\"triggerType\": \"pullRequest\""
                  }
                }
              }
            }
          ],
          "fingerprints": {
            "AssetFingerprint/v1": "",
            "ValidationFingerprint/v1": "[secret=8DFB5CD68EF3AD7A78D10284591F8D81ADD57FFDD8646DE80E846C63C95032DE]",
            "ValidationFingerprintHash/v1": "a5982fe308422353bb65ef8ed4a9715cedbcafb085e840eb025b3cee018b34c6",
            "AssetFingerprint/v2": "{}",
            "ValidationFingerprint/v2": "{\"secret\":\"8DFB5CD68EF3AD7A78D10284591F8D81ADD57FFDD8646DE80E846C63C95032DE\"}"
          },
          "rank": 53.78
        }
      ],
      "columnKind": "utf16CodeUnits"
    }
  ]
}