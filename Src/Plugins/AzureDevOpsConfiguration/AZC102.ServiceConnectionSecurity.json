{
  "SharedStringsFileName": "AzureDevOpsConfiguration.SharedStrings.txt",
  "ValidatorsAssemblyName": "AzureDevOpsConfiguration.dll",
  "Definitions": [
    {
      "Id": "AZC102",
      "Name": "ServiceConnectionShouldBeSecure",
      "Level": "Error",
      "Description": "Make sure service connections in AzureDevOps are secure.",
      "MatchExpressions": [
        {
          "Id": "AZC102/150",
          "Name": "DoNotUseClassicConnections",
          "Message": "A Classic Azure Service Connection [{0:serviceConnectionName}](https://dev.azure.com/{1:org}/{2:project}/_settings/adminservices?resourceId={3:serviceConnectionId}) was found in the '{1:org}' organization's '{2:project}' project.",
          "Description": "Do not use classic Azure service connections to access a subscription. Azure Resource Manager (ARM) Service Connections should be used instead, because they provide stronger access control (RBAC), better auditing, ARM-based deployment/governance, access to managed identities, access to key vaults, AAD-based authentication, support for tags, resource groups for easier security management, etc.\r\nRecommendation   : Delete the Azure Classic Service Connection and create a new service connection of type 'Azure Resource Manager' (ARM) scoped to a resource or resource group in your subscription.\r\nTo Delete existing service connection:\r\n1. Navigate to Project --> Project Settings --> Service connections\r\n2. Select your service connection from the list\r\n3. Click on '...' button next to 'Edit' button and select 'Delete' menu from menu list.\r\n\r\nTo create a new service connection:\r\n1. Navigate to Project --> Project Settings --> Service connections\r\n2. Click on 'New service connection' button\r\n3. Select 'Azure Resource Manager' as your service connection type.",
          "IntrafileRegexes": [
            "$AZC102.ServiceConnectionEntityType",
            "$AZC102.ServiceConnectionId",
            "$AZC102/150.AzureClassicType",
            "$AdoOrganizationName",
            "$AdoProjectName"
          ]
        },
        {
          "Id": "AZC102/190",
          "Name": "DoNotGrantAllPipelinesAccessToServiceConnections",
          "Message": "Service connection [{0:serviceConnectionName}](https://dev.azure.com/{1:org}/{2:project}/_settings/adminservices?resourceId={3:serviceConnectionId}) in the '{1:org}' organization’s '{2:project}' project is accessible to all pipelines. {4:validatorMessage}.",
          "Description": "Do not make service connections accessible to all pipelines. If a pipeline with access to the service connection uses a vulnerable component, an attacker may leverage this access to attack other pipelines with access to critical resources. Follow the principle of least privilege by only giving access to pipelines that explicitly need it.\r\nRecommendation:\r\n1. Navigate to Project --> Project Settings --> Service Connections\r\n2. Select your service connection from the list\r\n3. Click on the three dots and select ‘Security’\r\n4. Under 'Pipeline Permissions', click 'Restrict Permission' and add only pipelines that need explicit access to the service connection.",
          "IntrafileRegexes": [
            "$AZC102.ServiceConnectionEntityType",
            "$AZC102.ServiceConnectionId",
            "$AdoOrganizationName",
            "$AdoProjectName"
          ]
        }
      ]
    }
  ]
}
